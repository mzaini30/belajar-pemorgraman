@layout(default)

@section(head)
	@component(meta)
		@slot(judul)
			@attach(judul)
		@endslot
		@slot(deskripsi)
			Belajar "@attach(judul)" di kelas @attach(kelas)
		@endslot
	@endcomponent
@endsection

@section(body)
	<section class="wadah-post khusus-postingan">
		<section class="isi-post">
			<header>
				<a href="/">Belajar Pemrograman</a>
			</header>

			<section class="tengah">

				<section class="col-span-3 isi-postingan">

					<article>
						<h1>@attach(judul)</h1>
						<section class="isi-artikel">
							@attach(isi)
						</section>
					</article>

					<script>
						document.querySelectorAll('.shiki code .line span').forEach(x => {
							if (x.innerText == '+' || x.innerText == '-' || x.innerText == '!') {
								x.style.display = 'none'
							}
						})
					</script>

					@import(komentar)
				</section>
				
				<section class="menu-postingan">
					<div class="uppercase hidden"></div>

					<section class="parent-daftar-isi" v-cloak @mounted='toc'>
						<nav class="daftar-isi" v-if='data.length > 0'>
							<h2>Daftar Isi</h2>
							<ol>
								<li v-for='x in data'>
									<a :href="x.link">
										<span v-html='x.judul'></span>
									</a>
								</li>
							</ol>
						</nav>
					</section>

					<script>
						function toc(){
							let semuaToc = []
							const toc = document.querySelectorAll('.isi-artikel :where(h2, h3, h4, h5, h6)')
							for (let x of toc){
								let item = x.outerHTML.replace(/(^[\S\s]*?href=")([\S\s]*?)(" aria-hidden="true"><\/a>)([\S\s]*?)(<\/h.>)/g, `{"link": "$2", "judul": "$4"}`)
								semuaToc = [...semuaToc, JSON.parse(item)]
							}
							return semuaToc
						}

						PetiteVue.createApp({
							data: [],
							toc(){
								this.data = toc()
							}
						}).mount('.parent-daftar-isi')
					</script>

					<nav class="list-kelas" v-cloak>
						<h2>Kelas @attach(kelas)</h2>
						<ol>
							<li v-for='x in post'>
								<a :href="'/post/' + x.slug + '.html'" :class='x.slug == lokasiSekarang ? "uppercase" : ""'>{{x.judul}}</a>
							</li>
						</ol>
					</nav>

					<script type="module">
						import post from '/data/post.js'

						PetiteVue.createApp({
							post: post.filter(x => x.kelas == `@attach(kelas)`.trim()).sort((a, b) => (a.judul > b.judul) ? 1 : -1),
							lokasiSekarang: location.pathname.replace('/post/', '').replace('.html', '')
						}).mount('.wadah-post .list-kelas')
					</script>

					<nav class="gadget">
						@import(gadget)
					</nav>

				</section>
			</section>

			@import(footer)

		</section>
	</section>

	<section class="khusus-mobile" v-cloak @mounted='toc'>
		<section class="menu-melayang" @click='tampilMenu = true'>
			@import(menu)
		</section>

		<section class="menunya-mobile" v-if='tampilMenu'>
			<section class="isi">
				<nav class="mobile-daftar-isi" v-if='daftarIsi.length > 0'>
					<h2>Daftar Isi</h2>
					<ol>
						<li v-for='x in daftarIsi'>
							<a :href="x.link" @click='tampilMenu = false'>
								<span v-html='x.judul'></span>
							</a>
						</li>
					</ol>
				</nav>

				<h2>Kelas @attach(kelas)</h2>
				<ol>
					<li v-for='x in post'>
						<a :href="'/post/' + x.slug + '.html'" :class='x.slug == lokasiSekarang ? "uppercase" : ""'>{{x.judul}}</a>
					</li>
				</ol>

				<nav class="gadget-mobile">
					@import(gadget)
				</nav>
			</section>
		</section>

		<section class="tutup" v-if='tampilMenu' @click='tampilMenu = false'>
			@import(x)
		</section>
	</section>

	<script type="module">
		import post from '/data/post.js'

		PetiteVue.createApp({
			post: post.filter(x => x.kelas == `@attach(kelas)`.trim()).sort((a, b) => (a.judul > b.judul) ? 1 : -1),
			daftarIsi: [],
			toc(){
				this.daftarIsi = toc()
			},
			lokasiSekarang: location.pathname.replace('/post/', '').replace('.html', ''),
			tampilMenu: false
		}).mount('.khusus-mobile')
	</script>	

	<style lang="windi">
		.wadah-post {
			@apply p-20 px-[10%] bg-blue-300
		}	
		.daftar-isi {
			@apply mb-5
		}
		.wadah-post :where(header, article, .list-kelas, .daftar-isi, .kategorisasi, .terbaru) {
			@apply bg-white p-5
		}
		.wadah-post header {
			@apply text-5xl text-center mb-5 py-10;
			font-family: 'Sacramento', cursive;
		}

		.wadah-post :not(pre) > code {
			@apply bg-yellow-200
		}

		.wadah-post blockquote {
			@apply italic bg-gray-200 text-sm p-3
		}

		.wadah-post article :where(h1, h2, h3, h4, h5) {
			@apply font-bold
		}
		.wadah-post article img {
			@apply mx-auto block
		}
		.khusus-postingan article img {
			@apply shadow border border-gray-300
		}
		.wadah-post article h1 {
			@apply text-4xl
		}
		.wadah-post article h2 {
			@apply text-3xl
		}
		.wadah-post article h3 {
			@apply text-2xl
		}
		.wadah-post article h4 {
			@apply text-xl
		}
		.wadah-post article h5 {
			@apply text-lg
		}
		
		.wadah-post .tengah {
			@apply grid grid-cols-4 gap-5
		}
		.wadah-post article {
			@apply col-span-3
		}
		.wadah-post article * {
			@apply mb-5 last:mb-0;
		}
		.wadah-post article pre {
			@apply p-5
		}
		.wadah-post article a {
			@apply underline
		}

		.wadah-post :where(.list-kelas, .daftar-isi, .kategorisasi, .terbaru) h2 {
			@apply pb-5 text-3xl text-center pt-3;
			font-family: 'Sacramento', cursive;
		}
		.wadah-post :where(.list-kelas, .daftar-isi, .kategorisasi, .terbaru) li {
			@apply pb-3 last:pb-0 text-sm hover:underline;
		}

		[v-cloak] {
			@apply hidden
		}

		.wadah-post footer {
			@apply mt-5 bg-white p-5 text-center text-sm
		}
		.wadah-post footer a {
			@apply underline
		}

		.gist .gist-meta a,
		.gist .gist-data {
			@apply !mb-0
		}

		.khusus-postingan {
			@apply <sm:!p-3;
		}
		.menu-postingan {
			@apply <sm:hidden;
		}
		.isi-postingan {
			@apply <sm:col-span-4;
		}

		.khusus-mobile {
			@apply sm:hidden;
		}
		.menu-melayang {
			@apply bottom-0 left-0 p-2 fixed text-blue-500 cursor-pointer
		}
		.menunya-mobile {
			@apply min-h-screen w-full bg-black/50 top-0 left-0 fixed
		}
		.menunya-mobile .isi {
			@apply bg-white w-[70%] p-3 h-screen overflow-auto
		}
		.menunya-mobile .isi h2 {
			font-family: 'Sacramento', cursive;
			@apply text-2xl
		}
		.menunya-mobile .isi li {
			@apply text-sm pt-3
		}
		.tutup {
			@apply fixed top-0 right-0 p-3 text-white cursor-pointer
		}

		* {
			@apply break-words
		}
		pre {
			@apply overflow-auto
		}

		.khusus-postingan article :where(ol, ul) {
			@apply ml-5
		}
		.khusus-postingan article ol {
			@apply list-decimal
		}
		.khusus-postingan article ul {
			@apply list-disc
		}
		.khusus-postingan article blockquote {
			@apply mx-0
		}

		pre {-moz-tab-size: 2;} /* Firefox */
		pre {tab-size: 2;}

		:where(.gadget, .gadget-mobile) div {
			@apply mt-5
		}

		.mobile-daftar-isi {
			@apply mb-5
		}
	</style>
@endsection