!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(e.quicklink={})}(this,function(e){function r(r){return new Promise(function(e,n,t){(t=new XMLHttpRequest).open("GET",r,t.withCredentials=!0),t.onload=function(){(200===t.status?e:n)()},t.send()})}var n,o=(n=document.createElement("link")).relList&&n.relList.supports&&n.relList.supports("prefetch")?function(r){return new Promise(function(e,n,t){(t=document.createElement("link")).rel="prefetch",t.href=r,t.onload=e,t.onerror=n,document.head.appendChild(t)})}:r,p=window.requestIdleCallback||function(e){var n=Date.now();return setTimeout(function(){e({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-n))}})},1)},w=new Set;function v(e,n,t){if(t=navigator.connection){if(t.saveData)return Promise.reject(new Error("Cannot prefetch, Save-Data is enabled"));if(/2g/.test(t.effectiveType))return Promise.reject(new Error("Cannot prefetch, network conditions are poor"))}return Promise.all([].concat(e).map(function(e){if(!w.has(e))return w.add(e),(n?function(e){return window.fetch?fetch(e,{credentials:"include"}):r(e)}:o)(new URL(e,location.href).toString())}))}e.listen=function(t){var a,r,l,n,h,o,i,e,c,f,d,u,s;if(t=t||{},window.IntersectionObserver)return d=t.throttle||1/0||1,u=[],a=(e=[function(e){1<u.push(e)||m()},function(){s--,m()}])[s=0],r=e[1],l=t.limit||1/0,n=t.origins||[location.hostname],h=t.ignores||[],o=t.delay||0,i=[],e=t.timeoutFn||p,c="function"==typeof t.hrefFn&&t.hrefFn,f=new IntersectionObserver(function(e){e.forEach(function(e){var n;e.isIntersecting?(i.push((e=e.target).href),n=function(){-1!==i.indexOf(e.href)&&(f.unobserve(e),w.size<l&&a(function(){v(c?c(e):e.href,t.priority).then(r).catch(function(e){r(),t.onError&&t.onError(e)})}))},o?setTimeout(n,o):n()):-1<(n=i.indexOf((e=e.target).href))&&i.splice(n)})},{threshold:t.threshold||0}),e(function(){(t.el||document).querySelectorAll("a").forEach(function(e){n.length&&!n.includes(e.hostname)||function n(t,e){return Array.isArray(e)?e.some(function(e){return n(t,e)}):(e.test||e).call(e,t.href,t)}(e,h)||f.observe(e)})},{timeout:t.timeout||2e3}),function(){w.clear(),f.disconnect()};function m(){s<d&&0<u.length&&(u.shift()(),s++)}},e.prefetch=v});